<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>
      
        The Problem with Promises
      
       - Codio
    </title>

    
      <meta name="description" content="The Problem with Promises. We use Promises as much as possible in our Javascript code, because they save us from callback hell, and produce much more readable and organised code. Simply put, a Promise represents a value that...">
    

    
      <meta name="keywords" content="" />
    

    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/s/apple-touch-icon-144x144-precomposed.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/s/apple-touch-icon-114x114-precomposed.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/s/apple-touch-icon-72x72-precomposed.png" />
    <link rel="apple-touch-icon-precomposed" href="/s/apple-touch-icon-precomposed.png" />
    <link rel="shortcut icon" href="/s/favicon.png" />
    <!-- should actually be placed in your root dir -->
    <link rel="icon" type="image/ico" href="/s/favicon.ico" />

    <link href="../../../../css/normalize-ec2a8901.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../../../../css/boilerplate-cfa7d0a6.css" media="screen" rel="stylesheet" type="text/css" />

    

    <link href="https://codio.com/s/blog/feed.xml" rel="alternate" title="Code and Unload - While we code we often have lots of ideas brewing around. Ideas we'd like to unload onto you" type="application/atom+xml"/>
  </head>
  <body class="blog" data-spy="scroll" data-target="aside">
    <a id="top"></a>

    <div class="wrap">

      <nav>
  <div class="container">

    <nav class="clearfix">
      <a data-no-turbolink="true" href="/"><img width="150" src="../../../../img/logo-beta-111c10af.png" /></a>

      <ul id="site-nav">
        <li><a data-no-turbolink="true" href="/s/docs">Docs</a></li>
        <li><a data-no-turbolink="true" href="/s/pricing">Pricing</a></li>
        <li><a data-no-turbolink="true" href="/s/blog">Blog</a></li>
      </ul>

      <ul class="codio-nav" id="signedout-nav">
        <li><a href="/p/create" data-no-turbolink="1">Try Now</a></li>
        <li><a href="/p/login" data-no-turbolink="1">Sign In</a></li>
        <li><a href="/p/signup" data-no-turbolink="1">Sign Up</a></li>
      </ul>

      <ul class="codio-nav" id="signedin-nav">
        <li><a id="userlink" href="/" data-no-turbolink="1"></a></li>
        <li>
          <a id="gravatar" href="/" data-no-turbolink="1">
            <img src="" width="32" height="32" alt="">
          </a>
        </li>
      </ul>
    </nav>

  </div>
</nav>

  <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',(typeof intercomSettings === 'undefined' ? {} : intercomSettings));}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://static.intercomcdn.com/intercom.v1.js';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}};})()</script>


      
        
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>


  <div class="container clearfix">

    <section class="posts">

      

        
        

        <article>
          <section class="meta">
            <p class="date">
              <a class="home" href="/s/blog">&laquo;</a>
              <a href="/s/blog/2013/08/the-problem-with-promises/">August  6, 2013</a>
              
                <span class="author">by <a href="mailto:jmoss@codio.com">Joel Moss</a></span>
              
            </p>
          </section>

          <h1>The Problem with Promises</h1>

          
            <img alt="The Problem with Promises" align="left" class="blog-img" src="/s/img/blog/promises-f90ad5b6.svg" />
          

          <p>We use <a href="http://promisesaplus.com/">Promises</a> as much as possible in our Javascript code, because they save us from callback hell, and produce much more readable and organised code. Simply put, a Promise represents a value that may or may not yet be available.</p>

<p>We use <a href="http://api.jquery.com/category/deferred-object/">jQuery&#39;s Deferred object</a> when working with Promises, which is a slightly loose implementation of the <a href="http://promisesaplus.com/">Promises/A+ spec</a>. It might not be the <a href="http://domenic.me/2012/10/14/youre-missing-the-point-of-promises/">&quot;correct&quot;</a> way, but it works as expected.</p>

<p>We&#39;re doing a little refactoring of the core IDE and decided that the <a href="https://github.com/tildeio/rsvp.js">RSVP</a> Promises library was a more &quot;correct&quot; implementation, and so we started using that in the refactor branch. However, it turns out that RSVP and other Promise libraries that adhere to the spec include a nasty little gotcha that we feel is completely unacceptable when building production applications.</p>

<p>It all boils down to point <a href="http://promisesaplus.com/#point-50">3.2.6.2</a> of the spec:</p>

<blockquote>
<p>If either onFulfilled or onRejected throws an exception, <code>promise2</code> must be rejected with the thrown exception as the reason.</p>
</blockquote>

<p>Usually, when an exception is raised in Javascript, it is reported immediately by the browser as an error, which makes it very easy to act upon and see exactly when and where any issues arise. You can then use an <a href="http://errorception.com">exception tracking service</a> to report on errors as and when they happen, and respond accordingly.</p>

<p>The Promises/A+ spec states that when an exception is raised anywhere within your Promised code, the promise will be rejected. This includes <em>ANY and ALL exceptions</em>, which means the promise will swallow your exceptions - all the time, every time!</p>

<p>The nature of an exception is such that you do not and cannot know every time, when and where they will happen. Yes, you can - and should - catch common errors and handle them accordingly. But any unexpected errors are much harder to catch. So if your Promises swallow every one of these errors, you now have to write code to handle them. It now becomes almost like using <code>try/catch</code> all over the place, and if you find yourself doing that, then you&#39;re doing it wrong!</p>

<h2 id="toc_0">The Options</h2>

<p><strong><a href="https://github.com/tildeio/rsvp.js">RSVP</a> makes things worse</strong>, because if you don&#39;t catch your Promise rejections, then any exceptions will be completely ignored. You will never know if an error occurred, and when or where it happened.</p>

<p><strong><a href="http://documentup.com/kriskowal/q/">Q</a> handles this a little better</strong> by not swallowing exceptions when you don&#39;t catch its rejections. But that means you now have to ensure that you catch rejections in <em>every</em> Promise, and handle them.</p>

<p><strong><a href="http://jquery.com/">jQuery</a> is even better still</strong>, because it does not swallow our exceptions.</p>

<h2 id="toc_1">In Conclusion</h2>

<p>So we ended up back with jQuery which lets <strong>us</strong> decide how to handle exceptions. Any exception in a Promise is handled exactly as you would expect, and raises it immediately. It does not swallow it up, leaving you to wander why the hell your code is not working.</p>


          <div class="blog-social clearfix">
            <div class="blog-twitter">
              <a href="https://twitter.com/share" class="twitter-share-button" data-url="https://codio.com/s/blog/2013/08/the-problem-with-promises/" data-via="codiohq" data-size="small" data-count="none" data-text="The Problem with Promises">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
            </div>

            <div class="blog-gplus">
              <!-- Place this tag where you want the +1 button to render. -->
              <div class="g-plusone" data-size="medium" data-annotation="none" data="https://codio.com/s/blog/2013/08/the-problem-with-promises/"></div>

              <!-- Place this tag after the last +1 button tag. -->
              <script type="text/javascript">
                (function() {
                  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                  po.src = 'https://apis.google.com/js/plusone.js';
                  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
                })();
              </script>
            </div>

            <div class="blog-facebook">
              <div class="fb-like" data-send="false" data-href="https://codio.com/s/blog/2013/08/the-problem-with-promises/" data-width="400" data-show-faces="false"></div>
            </div>
          </div>
        </article>

      

      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'codio'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable Javascript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>

    <aside>
      <section class="all-posts">
        <h5><a href="https://codio.com/s/blog/feed.xml" target="_blank"><img size="14x14" src="../../../../img/feed-icon-fd8211de.png" />Subscribe</a></h5>
      </section>

      <section class="latest-posts">
        <h4>Latest posts...</h4>
        <ul>
          
            <li><a href="/s/blog/2013/09/from-the-frontline-30/">From the Front-line - #30</a></li>
          
            <li><a href="/s/blog/2013/09/from-the-frontline-29/">From the Front-line - #29</a></li>
          
            <li><a href="/s/blog/2013/09/from-the-frontline-28/">From the Front-line - #28</a></li>
          
            <li><a href="/s/blog/2013/09/from-the-frontline-27/">From the Front-line - #27</a></li>
          
            <li><a href="/s/blog/2013/08/from-the-frontline-26/">From the Front-line - #26</a></li>
          
            <li><a href="/s/blog/2013/08/from-the-frontline-25/">From the Front-line - #25</a></li>
          
            <li><a href="/s/blog/2013/08/from-the-frontline-24/">From the Front-line - #24</a></li>
          
            <li><a href="/s/blog/2013/08/from-the-frontline-23/">From the Front-line - #23</a></li>
          
        </ul>
      </section>

      <section class="all-posts">
        <h4><a href="/s/blog/all">all posts &raquo;</a></h4>
      </section>

      <div style="margin:35px 0 0 25px;">
        <a href="https://twitter.com/codiohq" class="twitter-follow-button" data-size="medium" data-show-count="false" data-lang="en">Follow us @codiohq</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
      </div>
    </aside>

  </div>


      

    </div>

    <footer>
  <div class="container clearfix">
    <div>
      <ul id="social-icons">
        <li><a target="_blank" href="https://plus.google.com/u/0/b/107423236292333764300/107423236292333764300/posts"><span></span>Google+</a></li>
        <li><a target="_blank" href="https://www.facebook.com/pages/Codio/164778707006897?ref=hl"><span></span>Facebook</a></li>
        <li><a target="_blank" href="https://twitter.com/codiohq"><span></span>Twitter</a></li>
      </ul>
    </div>

    <div>
      Copyright &copy; 2013 Application Craft Ltd.
      &nbsp;&nbsp;
      <a href="mailto:support@codio.com">Drop us a line...</a><br>
      All rights reserved. Read our <a href="/s/legal/privacy">Privacy policy</a> and other <a href="/s/legal">Legalese</a>.
    </div>

    <div>
      <a target="_blank" href="https://github.com/codio/site">This site is open source... Fork it!</a>
    </div>
  </div>
</footer>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/vendor/jquery.min-33074654.js"><\/script>')</script>
<script src="../../../../js/main-1e566bf8.js" type="text/javascript"></script>

  <script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39233819-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  </body>
</html>


<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'codio'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = '//' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script src="../../../../js/vendor/rainbow-04950e23.js" type="text/javascript"></script>
<script src="../../../../js/vendor/rainbow/linecount-61c79c39.js" type="text/javascript"></script>
<script src="../../../../js/vendor/rainbow/generic-b357dadf.js" type="text/javascript"></script>
<script src="../../../../js/vendor/rainbow/javascript-0bbbe42e.js" type="text/javascript"></script><link href="../../../../css/lib/rainbow/github-453e79e9.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../../../../css/lib/rainbow/linecount-9a1155c4.css" media="screen" rel="stylesheet" type="text/css" />
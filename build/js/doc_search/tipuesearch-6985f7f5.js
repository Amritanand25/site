/*
Tipue Search 2.0
Copyright (c) 2012 Tipue
Tipue Search is released under the MIT License
http://www.tipue.com/search
*/
!function(e){e.fn.tipuesearch=function(t){var i=e.extend({show:7,newWindow:!1,showURL:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!1,highlightEveryTerm:!1,mode:"static",contentLocation:"tipuesearch/tipuesearch_content.json"},t);return this.each(function(){function t(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function a(t,r){e("#tipue_search_content").hide();var o="",d=!1,s=!1,c=e(".docs aside form input").val().toLowerCase();c=e.trim(c);var y=c.split(" ");if(c.length>=i.minimumLength){if(r){for(var b=c,u=0;u<y.length;u++)for(var p=0;p<tipuesearch_replace.words.length;p++)y[u]==tipuesearch_replace.words[p].word&&(c=c.replace(y[u],tipuesearch_replace.words[p].replace_with),d=!0);y=c.split(" ")}for(var f=c,u=0;u<y.length;u++)for(var p=0;p<tipuesearch_stem.words.length;p++)y[u]==tipuesearch_stem.words[p].word&&(f=f+" "+tipuesearch_stem.words[p].stem);y=f.split(" ");var h=0;found=new Array;for(var u=0;u<l.pages.length;u++)if(void 0!=l.pages[u].t){for(var g=1e7,m=l.pages[u].t,p=0;p<y.length;p++){var v=new RegExp(y[p],"i");if(-1!=l.pages[u].t.search(v)&&(g-=2e3-u),l.pages[u].text&&-1!=l.pages[u].text.search(v)&&(g-=1500-u),i.highlightTerms){if(i.highlightEveryTerm)var w=new RegExp("("+y[p]+")","gi");else var w=new RegExp("("+y[p]+")","i");m=m.replace(w,"<em>$1</em>")}-1!=l.pages[u].b.search(v)&&(g-=1e3-u)}1e7>g&&(found[h++]=g+"^"+l.pages[u].r+"^"+m+"^"+l.pages[u].u)}if(0!=h){1==d&&(o+='<div id="tipue_search_warning_head">Showing results for '+c+"</div>",o+='<div id="tipue_search_warning">Show results for <a href="javascript:void(0)" id="tipue_search_replaced">'+b+"</a></div>"),1==h?o+='<div id="tipue_search_results_count">1 result for '+c+"...</div>":(c_c=h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),o+='<div id="tipue_search_results_count">'+c_c+" results for "+c+"...</div>"),found.sort();for(var x=0,u=0;u<found.length;u++){var _=found[u].split("^");if(x>=t&&x<i.show+t){o+='<div id="tipue_search_content_title"><a href="'+_[3]+'"'+n+">"+_[1]+"</a></div>";var k=_[2],C="",T=k.split(" ");if(T.length<i.descriptiveWords)C=k;else for(var p=0;p<i.descriptiveWords;p++)C+=T[p]+" ";C=e.trim(C),"."!=C.charAt(C.length-1)&&(C+=" ..."),o+='<div id="tipue_search_content_text">'+C+"</div>",i.showURL&&(o+='<div id="tipue_search_content_loc"><a href="'+_[3]+'"'+n+">"+_[3]+"</a></div>")}x++}if(h>i.show){var S=Math.ceil(h/i.show),E=t/i.show;if(o+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',t>0&&(o+='<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+(t-i.show)+"_"+r+'">&#171; Previous</a></li>'),4>=E){var O=S;S>5&&(O=5);for(var p=0;O>p;p++)o+=p==E?'<li class="current">'+(p+1)+"</li>":'<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+p*i.show+"_"+r+'">'+(p+1)+"</a></li>"}else{var O=S+4;O>S&&(O=S);for(var p=E;O>p;p++)o+=p==E?'<li class="current">'+(p+1)+"</li>":'<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+p*i.show+"_"+r+'">'+(p+1)+"</a></li>"}E+1!=S&&(o+='<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+(t+i.show)+"_"+r+'">Next &#187;</a></li>'),o+="</ul></div>"}}else o+='<div id="tipue_search_warning_head">Nothing found</div>'}else s?o+='<div id="tipue_search_warning_head">Nothing found</div><div id="tipue_search_warning">Common words are largely ignored</div>':(o+='<div id="tipue_search_warning_head">Search too short</div>',o+=1==i.minimumLength?'<div id="tipue_search_warning">Should be one character or more</div>':'<div id="tipue_search_warning">Should be '+i.minimumLength+" characters or more</div>");e(".docs article").fadeOut(function(){e("#tipue_search_content").html(o).fadeIn()}),e("#tipue_search_replaced").click(function(){a(0,!1)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),i=t.split("_");a(parseInt(i[0]),i[1])})}var l={pages:[]};e.ajaxSetup({async:!1}),"json"==i.mode&&e.getJSON(i.contentLocation,function(t){l=e.extend({},t)}),"static"==i.mode&&(l=e.extend({},tipuesearch));var n="";i.newWindow&&(n=' target="_blank"'),t("q")&&(e(".docs aside form input").val(t("q")),a(0,!0)),e(".docs aside form").submit(function(){return a(0,!0),!1})})}}(jQuery);
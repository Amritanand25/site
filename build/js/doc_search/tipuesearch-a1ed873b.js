/*
Tipue Search 2.0
Copyright (c) 2012 Tipue
Tipue Search is released under the MIT License
http://www.tipue.com/search
*/
!function(e){e.fn.tipuesearch=function(t){var n=e.extend({show:7,newWindow:!1,showURL:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!1,highlightEveryTerm:!1,mode:"static",contentLocation:"tipuesearch/tipuesearch_content.json"},t);return this.each(function(){function t(e){return decodeURIComponent((new RegExp("[?|&]"+e+"="+"([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function r(t,a){e("#tipue_search_content").hide();var s="",c=!1,l=!1,u=e(".docs aside form input").val().toLowerCase();u=e.trim(u);var d=u.split(" ");if(u.length>=n.minimumLength){if(a){for(var f=u,p=0;p<d.length;p++)for(var h=0;h<tipuesearch_replace.words.length;h++)d[p]==tipuesearch_replace.words[h].word&&(u=u.replace(d[p],tipuesearch_replace.words[h].replace_with),c=!0);d=u.split(" ")}for(var g=u,p=0;p<d.length;p++)for(var h=0;h<tipuesearch_stem.words.length;h++)d[p]==tipuesearch_stem.words[h].word&&(g=g+" "+tipuesearch_stem.words[h].stem);d=g.split(" ");var m=0;found=new Array;for(var p=0;p<i.pages.length;p++)if(void 0!=i.pages[p].t){for(var y=1e7,v=i.pages[p].t,h=0;h<d.length;h++){var b=new RegExp(d[h],"i");if(-1!=i.pages[p].t.search(b)&&(y-=2e3-p),i.pages[p].text&&-1!=i.pages[p].text.search(b)&&(y-=1500-p),n.highlightTerms){if(n.highlightEveryTerm)var x=new RegExp("("+d[h]+")","gi");else var x=new RegExp("("+d[h]+")","i");v=v.replace(x,"<em>$1</em>")}-1!=i.pages[p].b.search(b)&&(y-=1e3-p)}1e7>y&&(found[m++]=y+"^"+i.pages[p].r+"^"+v+"^"+i.pages[p].u)}if(0!=m){1==c&&(s+='<div id="tipue_search_warning_head">Showing results for '+u+"</div>",s+='<div id="tipue_search_warning">Show results for <a href="javascript:void(0)" id="tipue_search_replaced">'+f+"</a></div>"),1==m?s+='<div id="tipue_search_results_count">1 result for '+u+"...</div>":(c_c=m.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),s+='<div id="tipue_search_results_count">'+c_c+" results for "+u+"...</div>"),found.sort();for(var w=0,p=0;p<found.length;p++){var k=found[p].split("^");if(w>=t&&w<n.show+t){s+='<div id="tipue_search_content_title"><a href="'+k[3]+'"'+o+">"+k[1]+"</a></div>";var C=k[2],T="",_=C.split(" ");if(_.length<n.descriptiveWords)T=C;else for(var h=0;h<n.descriptiveWords;h++)T+=_[h]+" ";T=e.trim(T),"."!=T.charAt(T.length-1)&&(T+=" ..."),s+='<div id="tipue_search_content_text">'+T+"</div>",n.showURL&&(s+='<div id="tipue_search_content_loc"><a href="'+k[3]+'"'+o+">"+k[3]+"</a></div>")}w++}if(m>n.show){var E=Math.ceil(m/n.show),S=t/n.show;if(s+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',t>0&&(s+='<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+(t-n.show)+"_"+a+'">&#171; Previous</a></li>'),4>=S){var O=E;E>5&&(O=5);for(var h=0;O>h;h++)s+=h==S?'<li class="current">'+(h+1)+"</li>":'<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+h*n.show+"_"+a+'">'+(h+1)+"</a></li>"}else{var O=E+4;O>E&&(O=E);for(var h=S;O>h;h++)s+=h==S?'<li class="current">'+(h+1)+"</li>":'<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+h*n.show+"_"+a+'">'+(h+1)+"</a></li>"}S+1!=E&&(s+='<li><a href="javascript:void(0)" class="tipue_search_foot_box" id="'+(t+n.show)+"_"+a+'">Next &#187;</a></li>'),s+="</ul></div>"}}else s+='<div id="tipue_search_warning_head">Nothing found</div>'}else l?s+='<div id="tipue_search_warning_head">Nothing found</div><div id="tipue_search_warning">Common words are largely ignored</div>':(s+='<div id="tipue_search_warning_head">Search too short</div>',s+=1==n.minimumLength?'<div id="tipue_search_warning">Should be one character or more</div>':'<div id="tipue_search_warning">Should be '+n.minimumLength+" characters or more</div>");e(".docs article").fadeOut(function(){e("#tipue_search_content").html(s).fadeIn()}),e("#tipue_search_replaced").click(function(){r(0,!1)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),n=t.split("_");r(parseInt(n[0]),n[1])})}var i={pages:[]};e.ajaxSetup({async:!1}),"json"==n.mode&&e.getJSON(n.contentLocation,function(t){i=e.extend({},t)}),"static"==n.mode&&(i=e.extend({},tipuesearch));var o="";n.newWindow&&(o=' target="_blank"'),t("q")&&(e(".docs aside form input").val(t("q")),r(0,!0)),e(".docs aside form").submit(function(){return r(0,!0),!1})})}}(jQuery);
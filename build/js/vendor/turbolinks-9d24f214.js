!function(){var anchoredLink,assets,assetsChanged,browserCompatibleDocumentParser,browserSupportsPushState,cacheCurrentPage,changePage,constrainPageCacheTo,createDocument,crossOriginLink,currentState,executeScriptTags,extractAssets,extractLink,extractTitleAndBody,fetchHistory,fetchReplacement,handleClick,ignoreClick,initialized,installClickHandlerLast,intersection,noTurbolink,nonHtmlLink,nonStandardClick,pageCache,recallScrollPosition,referer,reflectNewUrl,reflectRedirectedUrl,rememberCurrentAssets,rememberCurrentState,rememberCurrentUrl,rememberInitialPage,resetScrollPosition,samePageLink,triggerEvent,visit,__indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};initialized=!1,currentState=null,referer=document.location.href,assets=[],pageCache=[],createDocument=null,visit=function(t){return browserSupportsPushState?(cacheCurrentPage(),reflectNewUrl(t),fetchReplacement(t)):document.location.href=t},fetchReplacement=function(t){var e;return triggerEvent("page:fetch"),e=new XMLHttpRequest,e.open("GET",t,!0),e.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),e.setRequestHeader("X-XHR-Referer",referer),e.onload=function(){var n;return n=createDocument(e.responseText),assetsChanged(n)?document.location.href=t:(changePage.apply(null,extractTitleAndBody(n)),reflectRedirectedUrl(e),resetScrollPosition(),triggerEvent("page:load"))},e.onabort=function(){return console.log("Aborted turbolink fetch!")},e.send()},fetchHistory=function(t){var e;return cacheCurrentPage(),(e=pageCache[t.position])?(changePage(e.title,e.body,e.breadcrumbs),recallScrollPosition(e),triggerEvent("page:restore")):fetchReplacement(document.location.href)},cacheCurrentPage=function(){return rememberInitialPage(),pageCache[currentState.position]={url:document.location.href,body:document.getElementById("doc-body"),breadcrumbs:document.getElementById("breadcrumbs"),title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},constrainPageCacheTo(10)},constrainPageCacheTo=function(t){return delete pageCache[currentState.position-t]},changePage=function(t,e,n){return document.title=t,document.getElementById("doc-body").parentNode.replaceChild(e,document.getElementById("doc-body")),document.getElementById("breadcrumbs").parentNode.replaceChild(n,document.getElementById("breadcrumbs")),executeScriptTags(),currentState=window.history.state,triggerEvent("page:change")},executeScriptTags=function(){var script,_i,_len,_ref,_ref1,_results;for(_ref=document.body.getElementsByTagName("script"),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)script=_ref[_i],(""===(_ref1=script.type)||"text/javascript"===_ref1)&&_results.push(eval(script.innerHTML));return _results},reflectNewUrl=function(t){return t!==document.location.href?(referer=document.location.href,window.history.pushState({turbolinks:!0,position:currentState.position+1},"",t)):void 0},reflectRedirectedUrl=function(t){var e;return(e=t.getResponseHeader("X-XHR-Current-Location"))?window.history.replaceState(currentState,"",e):void 0},rememberCurrentUrl=function(){return window.history.replaceState({turbolinks:!0,position:window.history.length-1},"",document.location.href)},rememberCurrentState=function(){return currentState=window.history.state},rememberCurrentAssets=function(){return assets=extractAssets(document)},rememberInitialPage=function(){return initialized?void 0:(rememberCurrentUrl(),rememberCurrentState(),createDocument=browserCompatibleDocumentParser(),initialized=!0)},recallScrollPosition=function(t){return window.scrollTo(t.positionX,t.positionY)},resetScrollPosition=function(){return window.scrollTo(0,0)},triggerEvent=function(t){var e;return e=document.createEvent("Events"),e.initEvent(t,!0,!0),document.dispatchEvent(e)},extractAssets=function(t){var e,n,i,o,r;for(o=t.head.childNodes,r=[],n=0,i=o.length;i>n;n++)e=o[n],(e.src||e.href)&&r.push(e.src||e.href);return r},assetsChanged=function(t){return intersection(extractAssets(t),assets).length!==assets.length},intersection=function(t,e){var n,i,o,r,a;for(t.length>e.length&&(r=[e,t],t=r[0],e=r[1]),a=[],i=0,o=t.length;o>i;i++)n=t[i],__indexOf.call(e,n)>=0&&a.push(n);return a},extractTitleAndBody=function(t){var e;return e=t.querySelector("title"),[null!=e?e.textContent:void 0,t.getElementById("doc-body"),t.getElementById("breadcrumbs")]},browserCompatibleDocumentParser=function(){var t,e,n,i;return t=function(t){return(new DOMParser).parseFromString(t,"text/html")},e=function(t){var e;return e=document.implementation.createHTMLDocument(""),e.open("replace"),e.write(t),e.close,e},window.DOMParser&&(n=t("<html><body><p>test")),1===(null!=n?null!=(i=n.body)?i.childNodes.length:void 0:void 0)?t:e},installClickHandlerLast=function(t){return t.defaultPrevented?void 0:(document.removeEventListener("click",handleClick),document.addEventListener("click",handleClick))},handleClick=function(t){var e;return t.defaultPrevented||(e=extractLink(t),"A"!==e.nodeName||ignoreClick(t,e))?void 0:(visit(e.href),t.preventDefault())},extractLink=function(t){var e;for(e=t.target;e!==document&&"A"!==e.nodeName;)e=e.parentNode;return e},samePageLink=function(t){return t.href===document.location.href},crossOriginLink=function(t){return location.protocol!==t.protocol||location.host!==t.host},anchoredLink=function(t){return(t.hash&&t.href.replace(t.hash,""))===location.href.replace(location.hash,"")||t.href===location.href+"#"},nonHtmlLink=function(t){return t.href.match(/\.[a-z]+(\?.*)?$/g)&&!t.href.match(/\.html?(\?.*)?$/g)},noTurbolink=function(t){for(var e;!e&&t!==document;)e=null!=t.getAttribute("data-no-turbolink"),t=t.parentNode;return e},nonStandardClick=function(t){return t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey},ignoreClick=function(t,e){return crossOriginLink(e)||anchoredLink(e)||nonHtmlLink(e)||noTurbolink(e)||nonStandardClick(t)},browserSupportsPushState=window.history&&window.history.pushState&&window.history.replaceState&&void 0!==window.history.state,browserSupportsPushState&&(rememberCurrentAssets(),document.addEventListener("click",installClickHandlerLast,!0),window.addEventListener("popstate",function(t){var e;return(null!=(e=t.state)?e.turbolinks:void 0)?fetchHistory(t.state):void 0})),this.Turbolinks={visit:visit}}.call(this);
window.Rainbow=function(){function e(e){var t,i=e.getAttribute&&e.getAttribute("data-language")||0;if(!i)for(e=e.attributes,t=0;t<e.length;++t)if("data-language"===e[t].nodeName)return e[t].nodeValue;return i}function t(t){var i=e(t)||e(t.parentNode);if(!i){var a=/\blang(?:uage)?-(\w+)/;(t=t.className.match(a)||t.parentNode.className.match(a))&&(i=t[1])}return i}function i(e,t){for(var i in b[m])if(i=parseInt(i,10),(e==i&&t==b[m][i]?0:i>=e&&t>=b[m][i])&&(delete b[m][i],delete p[m][i]),e>=i&&e<b[m][i]||t>i&&t<b[m][i])return!0;return!1}function a(e,t){return'<span class="'+e.replace(/\./g," ")+(u?" "+u:"")+'">'+t+"</span>"}function n(e,t,r,d){var c=e.exec(r);if(c){++v,!t.name&&"string"==typeof t.matches[0]&&(t.name=t.matches[0],delete t.matches[0]);var u=c[0],h=c.index,f=c[0].length+h,y=function(){function i(){n(e,t,r,d)}v%100>0?i():setTimeout(i,0)};if(i(h,f))y();else{var g=l(t.matches),w=function(e,i,n){if(e>=i.length)n(u);else{var l=c[i[e]];if(l){var r=t.matches[i[e]],d=r.language,h=r.name&&r.matches?r.matches:r,p=function(t,l,o){var r;r=0;var s;for(s=1;s<i[e];++s)c[s]&&(r+=c[s].length);l=o?a(o,l):l,u=u.substr(0,r)+u.substr(r).replace(t,l),w(++e,i,n)};d?s(l,d,function(e){p(l,e)}):"string"==typeof r?p(l,l,r):o(l,h.length?h:[h],function(e){p(l,e,r.matches?r.name:0)})}else w(++e,i,n)}};w(0,g,function(e){t.name&&(e=a(t.name,e)),p[m]||(p[m]={},b[m]={}),p[m][h]={replace:c[0],"with":e},b[m][h]=f,y()})}}else d()}function l(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i.sort(function(e,t){return t-e})}function o(e,t,i){function a(t,l){l<t.length?n(t[l].pattern,t[l],e,function(){a(t,++l)}):r(e,function(e){delete p[m],delete b[m],--m,i(e)})}++m,a(t,0)}function r(e,t){function i(e,t,a,n){if(a<t.length){++w;var l=t[a],o=p[m][l],e=e.substr(0,l)+e.substr(l).replace(o.replace,o["with"]),l=function(){i(e,t,++a,n)};w%250>0?l():setTimeout(l,0)}else n(e)}var a=l(p[m]);i(e,a,0,t)}function s(e,t,i){var a=f[t]||[],n=f[g]||[],t=y[t]?a:a.concat(n);o(e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),t,i)}function d(e,i,a){if(i<e.length){var n=e[i],l=t(n);return-1<(" "+n.className+" ").indexOf(" rainbow ")||!l?d(e,++i,a):(l=l.toLowerCase(),n.className+=n.className?" rainbow":"rainbow",s(n.innerHTML,l,function(t){n.innerHTML=t,p={},b={},h&&h(n,l),setTimeout(function(){d(e,++i,a)},0)}))}a&&a()}function c(e,t){var i,e=e&&"function"==typeof e.getElementsByTagName?e:document,a=e.getElementsByTagName("pre"),n=e.getElementsByTagName("code"),l=[];for(i=0;i<n.length;++i)l.push(n[i]);for(i=0;i<a.length;++i)a[i].getElementsByTagName("code").length||l.push(a[i]);d(l,0,t)}var u,h,p={},b={},f={},y={},m=0,g=0,v=0,w=0;return{extend:function(e,t,i){1==arguments.length&&(t=e,e=g),y[e]=i,f[e]=t.concat(f[e]||[])},b:function(e){h=e},a:function(e){u=e},color:function(e,t,i){return"string"==typeof e?s(e,t,i):"function"==typeof e?c(0,e):(c(e,t),void 0)}}}(),window.addEventListener?window.addEventListener("load",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color),Rainbow.onHighlight=Rainbow.b,Rainbow.addClass=Rainbow.a;
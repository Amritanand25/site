window.Rainbow=function(){function e(e){var t,n=e.getAttribute&&e.getAttribute("data-language")||0;if(!n)for(e=e.attributes,t=0;t<e.length;++t)if("data-language"===e[t].nodeName)return e[t].nodeValue;return n}function t(t){var n=e(t)||e(t.parentNode);if(!n){var i=/\blang(?:uage)?-(\w+)/;(t=t.className.match(i)||t.parentNode.className.match(i))&&(n=t[1])}return n}function n(e,t){for(var n in f[y])if(n=parseInt(n,10),(e==n&&t==f[y][n]?0:n>=e&&t>=f[y][n])&&(delete f[y][n],delete p[y][n]),e>=n&&e<f[y][n]||t>n&&t<f[y][n])return!0;return!1}function i(e,t){return'<span class="'+e.replace(/\./g," ")+(u?" "+u:"")+'">'+t+"</span>"}function a(e,t,l,c){var d=e.exec(l);if(d){++v,!t.name&&"string"==typeof t.matches[0]&&(t.name=t.matches[0],delete t.matches[0]);var u=d[0],h=d.index,m=d[0].length+h,g=function(){function n(){a(e,t,l,c)}v%100>0?n():setTimeout(n,0)};if(n(h,m))g();else{var b=r(t.matches),w=function(e,n,a){if(e>=n.length)a(u);else{var r=d[n[e]];if(r){var l=t.matches[n[e]],c=l.language,h=l.name&&l.matches?l.matches:l,p=function(t,r,o){var l;l=0;var s;for(s=1;s<n[e];++s)d[s]&&(l+=d[s].length);r=o?i(o,r):r,u=u.substr(0,l)+u.substr(l).replace(t,r),w(++e,n,a)};c?s(r,c,function(e){p(r,e)}):"string"==typeof l?p(r,r,l):o(r,h.length?h:[h],function(e){p(r,e,l.matches?l.name:0)})}else w(++e,n,a)}};w(0,b,function(e){t.name&&(e=i(t.name,e)),p[y]||(p[y]={},f[y]={}),p[y][h]={replace:d[0],"with":e},f[y][h]=m,g()})}}else c()}function r(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n.sort(function(e,t){return t-e})}function o(e,t,n){function i(t,r){r<t.length?a(t[r].pattern,t[r],e,function(){i(t,++r)}):l(e,function(e){delete p[y],delete f[y],--y,n(e)})}++y,i(t,0)}function l(e,t){function n(e,t,i,a){if(i<t.length){++w;var r=t[i],o=p[y][r],e=e.substr(0,r)+e.substr(r).replace(o.replace,o["with"]),r=function(){n(e,t,++i,a)};w%250>0?r():setTimeout(r,0)}else a(e)}var i=r(p[y]);n(e,i,0,t)}function s(e,t,n){var i=m[t]||[],a=m[b]||[],t=g[t]?i:i.concat(a);o(e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),t,n)}function c(e,n,i){if(n<e.length){var a=e[n],r=t(a);return-1<(" "+a.className+" ").indexOf(" rainbow ")||!r?c(e,++n,i):(r=r.toLowerCase(),a.className+=a.className?" rainbow":"rainbow",s(a.innerHTML,r,function(t){a.innerHTML=t,p={},f={},h&&h(a,r),setTimeout(function(){c(e,++n,i)},0)}))}i&&i()}function d(e,t){var n,e=e&&"function"==typeof e.getElementsByTagName?e:document,i=e.getElementsByTagName("pre"),a=e.getElementsByTagName("code"),r=[];for(n=0;n<a.length;++n)r.push(a[n]);for(n=0;n<i.length;++n)i[n].getElementsByTagName("code").length||r.push(i[n]);c(r,0,t)}var u,h,p={},f={},m={},g={},y=0,b=0,v=0,w=0;return{extend:function(e,t,n){1==arguments.length&&(t=e,e=b),g[e]=n,m[e]=t.concat(m[e]||[])},b:function(e){h=e},a:function(e){u=e},color:function(e,t,n){return"string"==typeof e?s(e,t,n):"function"==typeof e?d(0,e):(d(e,t),void 0)}}}(),window.addEventListener?window.addEventListener("load",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color),Rainbow.onHighlight=Rainbow.b,Rainbow.addClass=Rainbow.a;
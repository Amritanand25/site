window.Rainbow=function(){function e(e){var t,n=e.getAttribute&&e.getAttribute("data-language")||0;if(!n)for(e=e.attributes,t=0;t<e.length;++t)if("data-language"===e[t].nodeName)return e[t].nodeValue;return n}function t(t){var n=e(t)||e(t.parentNode);if(!n){var i=/\blang(?:uage)?-(\w+)/;(t=t.className.match(i)||t.parentNode.className.match(i))&&(n=t[1])}return n}function n(e,t){for(var n in h[g])if(n=parseInt(n,10),(e==n&&t==h[g][n]?0:n>=e&&t>=h[g][n])&&(delete h[g][n],delete p[g][n]),e>=n&&e<h[g][n]||t>n&&t<h[g][n])return!0;return!1}function i(e,t){return'<span class="'+e.replace(/\./g," ")+(u?" "+u:"")+'">'+t+"</span>"}function a(e,t,o,d){var c=e.exec(o);if(c){++v,!t.name&&"string"==typeof t.matches[0]&&(t.name=t.matches[0],delete t.matches[0]);var u=c[0],f=c.index,y=c[0].length+f,b=function(){function n(){a(e,t,o,d)}v%100>0?n():setTimeout(n,0)};if(n(f,y))b();else{var m=r(t.matches),x=function(e,n,a){if(e>=n.length)a(u);else{var r=c[n[e]];if(r){var o=t.matches[n[e]],d=o.language,f=o.name&&o.matches?o.matches:o,p=function(t,r,l){var o;o=0;var s;for(s=1;s<n[e];++s)c[s]&&(o+=c[s].length);r=l?i(l,r):r,u=u.substr(0,o)+u.substr(o).replace(t,r),x(++e,n,a)};d?s(r,d,function(e){p(r,e)}):"string"==typeof o?p(r,r,o):l(r,f.length?f:[f],function(e){p(r,e,o.matches?o.name:0)})}else x(++e,n,a)}};x(0,m,function(e){t.name&&(e=i(t.name,e)),p[g]||(p[g]={},h[g]={}),p[g][f]={replace:c[0],"with":e},h[g][f]=y,b()})}}else d()}function r(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n.sort(function(e,t){return t-e})}function l(e,t,n){function i(t,r){r<t.length?a(t[r].pattern,t[r],e,function(){i(t,++r)}):o(e,function(e){delete p[g],delete h[g],--g,n(e)})}++g,i(t,0)}function o(e,t){function n(e,t,i,a){if(i<t.length){++x;var r=t[i],l=p[g][r],e=e.substr(0,r)+e.substr(r).replace(l.replace,l["with"]),r=function(){n(e,t,++i,a)};x%250>0?r():setTimeout(r,0)}else a(e)}var i=r(p[g]);n(e,i,0,t)}function s(e,t,n){var i=y[t]||[],a=y[m]||[],t=b[t]?i:i.concat(a);l(e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),t,n)}function d(e,n,i){if(n<e.length){var a=e[n],r=t(a);return-1<(" "+a.className+" ").indexOf(" rainbow ")||!r?d(e,++n,i):(r=r.toLowerCase(),a.className+=a.className?" rainbow":"rainbow",s(a.innerHTML,r,function(t){a.innerHTML=t,p={},h={},f&&f(a,r),setTimeout(function(){d(e,++n,i)},0)}))}i&&i()}function c(e,t){var n,e=e&&"function"==typeof e.getElementsByTagName?e:document,i=e.getElementsByTagName("pre"),a=e.getElementsByTagName("code"),r=[];for(n=0;n<a.length;++n)r.push(a[n]);for(n=0;n<i.length;++n)i[n].getElementsByTagName("code").length||r.push(i[n]);d(r,0,t)}var u,f,p={},h={},y={},b={},g=0,m=0,v=0,x=0;return{extend:function(e,t,n){1==arguments.length&&(t=e,e=m),b[e]=n,y[e]=t.concat(y[e]||[])},b:function(e){f=e},a:function(e){u=e},color:function(e,t,n){return"string"==typeof e?s(e,t,n):"function"==typeof e?c(0,e):(c(e,t),void 0)}}}(),window.addEventListener?window.addEventListener("load",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color),Rainbow.onHighlight=Rainbow.b,Rainbow.addClass=Rainbow.a;
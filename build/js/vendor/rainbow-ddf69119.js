window.Rainbow=function(){function e(e){var t,i=e.getAttribute&&e.getAttribute("data-language")||0;if(!i)for(e=e.attributes,t=0;t<e.length;++t)if("data-language"===e[t].nodeName)return e[t].nodeValue;return i}function t(t){var i=e(t)||e(t.parentNode);if(!i){var n=/\blang(?:uage)?-(\w+)/;(t=t.className.match(n)||t.parentNode.className.match(n))&&(i=t[1])}return i}function i(e,t){for(var i in f[m])if(i=parseInt(i,10),(e==i&&t==f[m][i]?0:i>=e&&t>=f[m][i])&&(delete f[m][i],delete p[m][i]),e>=i&&e<f[m][i]||t>i&&t<f[m][i])return!0;return!1}function n(e,t){return'<span class="'+e.replace(/\./g," ")+(u?" "+u:"")+'">'+t+"</span>"}function a(e,t,l,d){var c=e.exec(l);if(c){++v,!t.name&&"string"==typeof t.matches[0]&&(t.name=t.matches[0],delete t.matches[0]);var u=c[0],h=c.index,y=c[0].length+h,b=function(){function i(){a(e,t,l,d)}v%100>0?i():setTimeout(i,0)};if(i(h,y))b();else{var g=r(t.matches),w=function(e,i,a){if(e>=i.length)a(u);else{var r=c[i[e]];if(r){var l=t.matches[i[e]],d=l.language,h=l.name&&l.matches?l.matches:l,p=function(t,r,o){var l;l=0;var s;for(s=1;s<i[e];++s)c[s]&&(l+=c[s].length);r=o?n(o,r):r,u=u.substr(0,l)+u.substr(l).replace(t,r),w(++e,i,a)};d?s(r,d,function(e){p(r,e)}):"string"==typeof l?p(r,r,l):o(r,h.length?h:[h],function(e){p(r,e,l.matches?l.name:0)})}else w(++e,i,a)}};w(0,g,function(e){t.name&&(e=n(t.name,e)),p[m]||(p[m]={},f[m]={}),p[m][h]={replace:c[0],"with":e},f[m][h]=y,b()})}}else d()}function r(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i.sort(function(e,t){return t-e})}function o(e,t,i){function n(t,r){r<t.length?a(t[r].pattern,t[r],e,function(){n(t,++r)}):l(e,function(e){delete p[m],delete f[m],--m,i(e)})}++m,n(t,0)}function l(e,t){function i(e,t,n,a){if(n<t.length){++w;var r=t[n],o=p[m][r],e=e.substr(0,r)+e.substr(r).replace(o.replace,o["with"]),r=function(){i(e,t,++n,a)};w%250>0?r():setTimeout(r,0)}else a(e)}var n=r(p[m]);i(e,n,0,t)}function s(e,t,i){var n=y[t]||[],a=y[g]||[],t=b[t]?n:n.concat(a);o(e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),t,i)}function d(e,i,n){if(i<e.length){var a=e[i],r=t(a);return-1<(" "+a.className+" ").indexOf(" rainbow ")||!r?d(e,++i,n):(r=r.toLowerCase(),a.className+=a.className?" rainbow":"rainbow",s(a.innerHTML,r,function(t){a.innerHTML=t,p={},f={},h&&h(a,r),setTimeout(function(){d(e,++i,n)},0)}))}n&&n()}function c(e,t){var i,e=e&&"function"==typeof e.getElementsByTagName?e:document,n=e.getElementsByTagName("pre"),a=e.getElementsByTagName("code"),r=[];for(i=0;i<a.length;++i)r.push(a[i]);for(i=0;i<n.length;++i)n[i].getElementsByTagName("code").length||r.push(n[i]);d(r,0,t)}var u,h,p={},f={},y={},b={},m=0,g=0,v=0,w=0;return{extend:function(e,t,i){1==arguments.length&&(t=e,e=g),b[e]=i,y[e]=t.concat(y[e]||[])},b:function(e){h=e},a:function(e){u=e},color:function(e,t,i){return"string"==typeof e?s(e,t,i):"function"==typeof e?c(0,e):(c(e,t),void 0)}}}(),window.addEventListener?window.addEventListener("load",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color),Rainbow.onHighlight=Rainbow.b,Rainbow.addClass=Rainbow.a;
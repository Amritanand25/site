window.Rainbow=function(){function e(e){var t,n=e.getAttribute&&e.getAttribute("data-language")||0;if(!n)for(e=e.attributes,t=0;t<e.length;++t)if("data-language"===e[t].nodeName)return e[t].nodeValue;return n}function t(t){var n=e(t)||e(t.parentNode);if(!n){var i=/\blang(?:uage)?-(\w+)/;(t=t.className.match(i)||t.parentNode.className.match(i))&&(n=t[1])}return n}function n(e,t){for(var n in h[v])if(n=parseInt(n,10),(e==n&&t==h[v][n]?0:n>=e&&t>=h[v][n])&&(delete h[v][n],delete p[v][n]),e>=n&&e<h[v][n]||t>n&&t<h[v][n])return!0;return!1}function i(e,t){return'<span class="'+e.replace(/\./g," ")+(f?" "+f:"")+'">'+t+"</span>"}function r(e,t,s,l){var u=e.exec(s);if(u){++b,!t.name&&"string"==typeof t.matches[0]&&(t.name=t.matches[0],delete t.matches[0]);var f=u[0],d=u.index,g=u[0].length+d,m=function(){function n(){r(e,t,s,l)}b%100>0?n():setTimeout(n,0)};if(n(d,g))m();else{var y=a(t.matches),w=function(e,n,r){if(e>=n.length)r(f);else{var a=u[n[e]];if(a){var s=t.matches[n[e]],l=s.language,d=s.name&&s.matches?s.matches:s,p=function(t,a,o){var s;s=0;var c;for(c=1;c<n[e];++c)u[c]&&(s+=u[c].length);a=o?i(o,a):a,f=f.substr(0,s)+f.substr(s).replace(t,a),w(++e,n,r)};l?c(a,l,function(e){p(a,e)}):"string"==typeof s?p(a,a,s):o(a,d.length?d:[d],function(e){p(a,e,s.matches?s.name:0)})}else w(++e,n,r)}};w(0,y,function(e){t.name&&(e=i(t.name,e)),p[v]||(p[v]={},h[v]={}),p[v][d]={replace:u[0],"with":e},h[v][d]=g,m()})}}else l()}function a(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n.sort(function(e,t){return t-e})}function o(e,t,n){function i(t,a){a<t.length?r(t[a].pattern,t[a],e,function(){i(t,++a)}):s(e,function(e){delete p[v],delete h[v],--v,n(e)})}++v,i(t,0)}function s(e,t){function n(e,t,i,r){if(i<t.length){++w;var a=t[i],o=p[v][a],e=e.substr(0,a)+e.substr(a).replace(o.replace,o["with"]),a=function(){n(e,t,++i,r)};w%250>0?a():setTimeout(a,0)}else r(e)}var i=a(p[v]);n(e,i,0,t)}function c(e,t,n){var i=g[t]||[],r=g[y]||[],t=m[t]?i:i.concat(r);o(e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),t,n)}function l(e,n,i){if(n<e.length){var r=e[n],a=t(r);return-1<(" "+r.className+" ").indexOf(" rainbow ")||!a?l(e,++n,i):(a=a.toLowerCase(),r.className+=r.className?" rainbow":"rainbow",c(r.innerHTML,a,function(t){r.innerHTML=t,p={},h={},d&&d(r,a),setTimeout(function(){l(e,++n,i)},0)}))}i&&i()}function u(e,t){var n,e=e&&"function"==typeof e.getElementsByTagName?e:document,i=e.getElementsByTagName("pre"),r=e.getElementsByTagName("code"),a=[];for(n=0;n<r.length;++n)a.push(r[n]);for(n=0;n<i.length;++n)i[n].getElementsByTagName("code").length||a.push(i[n]);l(a,0,t)}var f,d,p={},h={},g={},m={},v=0,y=0,b=0,w=0;return{extend:function(e,t,n){1==arguments.length&&(t=e,e=y),m[e]=n,g[e]=t.concat(g[e]||[])},b:function(e){d=e},a:function(e){f=e},color:function(e,t,n){return"string"==typeof e?c(e,t,n):"function"==typeof e?u(0,e):(u(e,t),void 0)}}}(),window.addEventListener?window.addEventListener("load",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color),Rainbow.onHighlight=Rainbow.b,Rainbow.addClass=Rainbow.a;